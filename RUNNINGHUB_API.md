# RunningHub API Readme

## Введение

Добро пожаловать в **RunningHub API**, разработанный для упрощения использования функционала ComfyUI, размещенного в облаке RunningHub. С помощью этого API вы можете массово запускать различные сложные рабочие процессы и инициировать задачи последовательно. Если рабочий процесс корректно функционирует на платформе RunningHub, вы можете без проблем интегрировать его в свой продукт или гибко применять в любых сценариях, требующих AI-воркфлоу.

## Начало работы

Перед использованием RunningHub API убедитесь, что выполнены следующие шаги:

1. **Регистрация**: Зарегистрируйтесь на сайте RunningHub и активируйте членские привилегии. В настоящее время бесплатные пользователи не имеют доступа к RunningHub API.

2. **Получение ID рабочего процесса**: Откройте нужный воркфлоу и обратите внимание на его ID в адресной строке, так как наши API-запросы основаны на этом ID.

   *Пример*: в следующем URL: `https://www.runninghub.ai/workflow/1851826914200891393`, ID рабочего процесса — `1851826914200891393`.

3. **Проверка работоспособности**: Убедитесь, что вы можете запустить этот воркфлоу вручную и он работает корректно, иначе при использовании API возникнет ошибка.

## 1. Получение API-ключа

RunningHub автоматически генерирует уникальный 32-символьный API-ключ для каждого пользователя, который служит единственным идентификатором вашей учетной записи.

Чтобы просмотреть ваш API-ключ:

- Перейдите на главную страницу [RunningHub](https://www.runninghub.ai/), войдите в свою учетную запись и откройте плавающее меню профиля в правом верхнем углу страницы. Держите ваш API-ключ в безопасности и не разглашайте его, так как он потребуется в последующих шагах.

## 2. Простое выполнение рабочего процесса

Этот метод запуска воркфлоу эквивалентен нажатию кнопки "Run" без изменения каких-либо исходных параметров. Он подходит для задач, таких как случайный выбор.

**Endpoint**: `POST /task/openapi/create`

**Заголовки**:

| Header        | Value              | Notes |
|---------------|--------------------|-------|
| Content-Type  | application/json   |       |

**Данные запроса**:

| Parameter  | Type   | Required | Notes |
|------------|--------|----------|-------|
| workflowId | string | Yes      |       |
| apiKey     | string | Yes      |       |

**Ответ**:

| Parameter         | Type   | Notes                                                                                           |
|-------------------|--------|-------------------------------------------------------------------------------------------------|
| msg               | string | Обычно: "success"                                                                               |
| data: taskId      | string | Уникальный ID задачи для этого запуска, соответствует ID задач в списках рабочей области сайта  |
| data: clientId    | string | ID клиента для этого запуска, в основном для устранения неполадок (обычно можно игнорировать)   |
| data: promptTips  | string | Подробности об ошибке, если она возникла                                                        |
| data: taskStatus  | string | Статусы: QUEUED (В очереди), RUNNING (Выполняется), SUCCESS (Выполнено успешно), FAILED (Ошибка)|

**Пример кода**:

Этот метод выполнения воркфлоу эквивалентен нажатию кнопки "Run" без изменения исходных параметров. Если вы хотите сразу приступить к работе, просто скопируйте следующий код, заменив `workflowId` и `apiKey` на ваши собственные значения.

```python
import requests

url = "https://www.runninghub.ai/task/openapi/create"
payload = {
    "workflowId": "ВАШ_WORKFLOW_ID",
    "apiKey": "ВАШ_API_KEY"
}
headers = {
    "Content-Type": "application/json"
}

response = requests.post(url, json=payload, headers=headers)
print(response.json())
```

## 3. Выполнение рабочего процесса с параметрами

Если вы хотите изменить параметры перед запуском воркфлоу, используйте следующий метод.

**Endpoint**: `POST /task/openapi/createWithParams`

**Заголовки**:

| Header        | Value              | Notes |
|---------------|--------------------|-------|
| Content-Type  | application/json   |       |

**Данные запроса**:

| Parameter  | Type   | Required | Notes |
|------------|--------|----------|-------|
| workflowId | string | Yes      |       |
| apiKey     | string | Yes      |       |
| params     | dict   | Yes      | Параметры для изменения в формате ключ-значение |

**Ответ**:

| Parameter         | Type   | Notes                                                                                           |
|-------------------|--------|-------------------------------------------------------------------------------------------------|
| msg               | string | Обычно: "success"                                                                               |
| data: taskId      | string | Уникальный ID задачи для этого запуска, соответствует ID задач в списках рабочей области сайта  |
| data: clientId    | string | ID клиента для этого запуска, в основном для устранения неполадок (обычно можно игнорировать)   |
| data: promptTips  | string | Подробности об ошибке, если она возникла                                                        |
| data: taskStatus  | string | Статусы: QUEUED (В очереди), RUNNING (Выполняется), SUCCESS (Выполнено успешно), FAILED (Ошибка)|

**Пример кода**:

```python
import requests

url = "https://www.runninghub.ai/task/openapi/createWithParams"
payload = {
    "workflowId": "ВАШ_WORKFLOW_ID",
    "apiKey": "ВАШ_API_KEY",
    "params": {
        "param1": "значение1",
        "param2": "значение2"
    }
}
headers = {
    "Content-Type": "application/json"
}

response = requests.post(url, json=payload, headers=headers)
print(response.json())
```

## 4. Проверка статуса задачи

Вы можете проверить статус ранее запущенной задачи с помощью следующего метода.

**Endpoint**: `GET /task/openapi/status`

**Параметры запроса**:

| Parameter | Type   | Required | Notes |
|-----------|--------|----------|-------|
| taskId    | string | Yes      | ID задачи, полученный при создании задачи |
| apiKey    | string | Yes      | Ваш API-ключ                             |

**Ответ**:

| Parameter        | Type   | Notes                                                                                           |
|------------------|--------|-------------------------------------------------------------------------------------------------|
| msg              | string | Обычно: "success"                                                                               |
| data: taskStatus | string | Статусы: QUEUED (В очереди), RUNNING (Выполняется), SUCCESS (Выполнено успешно), FAILED (Ошибка)|
| data: result     | dict   | Результаты выполнения задачи, если она завершена                                                |

**Пример кода**:

```python
import requests

url = "https://www.runninghub.ai/task/openapi/status"
params = {
    "taskId": "ВАШ_TASK_ID",
    "apiKey": "ВАШ_API_KEY"
}

response = requests.get(url, params=params)
print(response.json())
```

## 5. Обработка ошибок

При использовании RunningHub API могут возникнуть следующие типы ошибок:

1. **Аутентификация**: 
   - Неверный API-ключ
   - Недостаточно прав для выполнения операции

2. **Валидация данных**:
   - Некорректный ID воркфлоу
   - Неправильный формат параметров
   - Отсутствие обязательных параметров

3. **Выполнение задачи**:
   - Превышено время ожидания
   - Внутренняя ошибка сервера
   - Недостаточно ресурсов для выполнения задачи

**Рекомендации по обработке ошибок**:
- Всегда проверяйте поле `msg` в ответе
- Используйте `promptTips` для получения детальной информации об ошибке
- Реализуйте механизмы повторных попыток для временных ошибок
- Логируйте все ошибки для последующего анализа

## 6. Безопасность

- Храните API-ключ в защищенном месте (например, в переменных окружения)
- Не передавайте API-ключ напрямую в коде
- Используйте HTTPS для всех запросов
- Регулярно обновляйте ключ доступа

## 7. Лимиты и тарификация

- Количество запросов ограничено тарифным планом
- Превышение лимитов может привести к временной блокировке
- Рекомендуется использовать механизмы кэширования и оптимизации запросов

## Заключение

RunningHub API предоставляет мощный и гибкий инструмент для автоматизации AI-воркфлоу. Следуя этой документации, вы сможете легко интегрировать RunningHub в свои проекты.

**Удачи в разработке!** 🚀
